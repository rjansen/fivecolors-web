<div class="container-fluid">
    <div class="row-fluid clearfix">
        <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6" style="padding: 0px;" (keyup.enter)="search()">
            <div class="row-fluid clearfix">
                <div class="parameterInputTop input-group input-group-sm col-xs-12 col-sm-12 col-md-3 col-lg-4 col-xl-4">
                    <input #filterIndex class="form-control" placeholder="Card Set #" type="text" [(ngModel)]="parameter.index" (keyup.enter)="search()"
                    />
                </div>
                <div class="parameterInputTop input-group input-group-sm col-xs-12 col-sm-12 col-md-9 col-lg-8 col-xl-8">
                    <!--<span class="input-group-addon" id="basic-addon1">Set</span>-->
                    <div class="input-group-btn">
                        <button type="button" class="expansionFrame btn input-group-addon dropdown-toggle" style="width: 100%;" data-toggle="dropdown"
                        aria-haspopup="true" aria-expanded="false">
                            <span [hidden]="parameter.expansion != undefined">Set</span>
                        </button>
                        <div class="expansionDropDown dropdown-menu" (keyup.enter)="search()">
                            <a class="pointerCursor dropdown-item" (click)=addExpansionParameter(null)>
                                <i class="fa fa-close text-muted expansionImageRemoveSelect"></i>
                                <span class="expansionNameSelect"><strong>Remove Expansion</strong></span>
                            </a>
                            <a class="pointerCursor dropdown-item" (click)=addExpansionParameter(expansion) *ngFor="let expansion of model.expansions">
                                <img class="expansionImageSelect" src="/api/asset/{{expansion.idAsset}}">
                                <span class="expansionNameSelect"><strong>{{expansion.name}}</strong></span>
                            </a>
                        </div>
                    </div>
                    <div class="parameterExpansion form-control" *ngIf="parameter.expansion != undefined">
                        <img class="expansionImage" src="/api/asset/{{parameter.expansion.idAsset}}">
                        <span class="expansionName"><strong>{{parameter.expansion.name}}</strong></span>
                    </div>
                </div>
            </div>
            <div class="row-fluid clearfix">
                <div class="parameterInput input-group input-group-sm col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">
                    <span class="input-group-addon">
                        <input type="checkbox" data-toggle="tooltip" data-placement="bottom" title="Check to negate the type filter">
                    </span>
                    <input type="text" class="form-control" placeholder="Type Rx"
                        [(ngModel)]="parameter.type" (keyup.enter)="search()">
                </div>
                <div class="parameterInput input-group input-group-sm col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">
                    <span class="input-group-addon">
                        <input type="checkbox" data-toggle="tooltip" data-placement="bottom" title="Check to negate the cost filter">
                    </span>
                    <input type="text" class="form-control" placeholder="Cost Rx"
                        [(ngModel)]="parameter.cost" (keyup.enter)="search()">
                </div>
            </div>
            <div class="row-fluid clearfix">
                <div class="parameterInput input-group input-group-sm col-xs-6">
                    <input class="form-control" placeholder="Card Name" type="text" 
                        [(ngModel)]="parameter.name" (keyup.enter)="search()" />
                </div>
                <div class="parameterInput input-group input-group-sm col-xs-3">
                    <input class="form-control" placeholder="QTD" type="number" min="0" 
                        [(ngModel)]="parameter.stockQuantity" (keyup.enter)="search()" />
                </div>
                <div class="col-xs-3 parameterInput">
                    <div class="btn-group pull-right">
                        <button type="button" [disabled]="filterIsInValid()" 
                            class="imageBtn btn btn-secondary" (click)="search()">
                            <i class="fa fa-search" *ngIf="!model.querying"></i>
                            <i class="fa fa-circle-o-notch fa-spin" *ngIf="model.querying"></i>
                        </button>
                        <button type="button" [disabled]="filterIsInValid()" class="btn btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="sr-only">Toggle Dropdown</span>
                        </button>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" (click)="searchOnNewPage()">On New Page</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" (click)="closeSearchResults()">Close Page</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="searchResults row-fluid clearfix">
                <div class="searchResultsHead btn-group" role="group" style="margin-top: 5px; margin-bottom: 5px;"
                        *ngIf="model.searchResults != undefined">
                    <button type="button" class="btn btn-sm searchResultsTitle"
                        [class.active]="isCurrentSearchResults(k)"
                        *ngFor="let searchResultsItem of model.searchResultsList; let k = index"
                        (click)="selectResult(searchResultsItem, k)" 
                        [class.btn-secondary-outline]="model.searchResults.length <= 0"
                        [class.btn-success-outline]="model.searchResults.length > 0">
                        C{{k}} <span class="badge">{{searchResultsItem.length}}</span>
                    </button>
                </div>
                <div class="container-fluid" style="padding: 0px;">
                    <div class="row-fluid clearfix">
                        <div class="searchResultsBody col-xs-12" style="padding: 0px;">
                            <div class="searchResultsItem col-xs-12 col-sm-6 col-md-6 col-lg-4 col-xl-4" *ngFor="let searchItem of model.searchResults">
                                <div class="cardFrame card text-xs-center">
                                    <div class="card-header text-xs-center">
                                        <span class="searchResultsItemTitle"><strong>{{searchItem.name}}</strong></span>
                                        <img src="/api/asset/{{searchItem.expansion.idAsset}}" style="height: 18px; vertical-align: middle;" />
                                    </div>
                                    <img class="card-img searchResultsDeckImg" src="/api/asset/{{searchItem.idAsset}}" 
                                    [class.show50]="searchItem.inventoryCard.quantity <= 0"
                                    />
                                    <img class="card-img" ngShow="false" ngSrc="/web/app/assets/images/magic_card.jpg" />
                                    <div class="actionOverlay card-img-overlay">
                                        <div class="cardDetailsDeck center-block">
                                            <div class="cardQtdLabel" 
                                            [class.text-warning]="isChangedCardQuantity(searchItem)" 
                                            [class.text-danger]="getCardQuantity(searchItem) <= 0">
                                                {{getCardQuantity(searchItem)}}</div>
                                            <div class="actionPanel hide">
                                                <button class="action btn btn-secondary" (click)="removeCard(searchItem)">
                                                    <i class="fa fa-minus-circle"></i>
                                                </button>
                                                <button class="action btn btn-secondary" (click)="addCard(searchItem)">
                                                    <i class="fa fa-plus-circle"></i>
                                                </button>
                                                <button class="action btn btn-secondary" (click)="showCard(searchItem)">
                                                    <i class="fa fa-eye"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6" style="padding: 0px;">
            <div class="container-fluid" style="padding: 0px;">
                <div class="row-fluid clearfix">
                    <form #getDeck="ngForm" (ngSubmit)="find()">
                        <div class="col-xs-2" style="padding: 0px;">
                            <div class="idDeckInput input-group input-group-sm">
                                <input #idDeck required ngControl="idDeck" name="idDeck" [(ngModel)]="deck.id" 
                                    class="form-control" placeholder="#" type="text" />
                            </div>
                        </div>
                        <div class="col-xs-1 actionColumn parameterInputTop">
                            <div class="pull-right">
                                <div class="updateDeckBtn btn-group">
                                    <button type="submit" [disabled]="!getDeck.form.valid" 
                                        class="imageBtn btn btn-secondary">
                                        <i class="fa fa-folder-open" *ngIf="!model.getting"></i>
                                        <i class="fa fa-circle-o-notch fa-spin" *ngIf="model.getting"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                    <form #postDeck="ngForm" (ngSubmit)="update()">
                        <div class="col-xs-8" style="padding: 0px; padding-left: 0px;">
                            <div class="nameInput input-group input-group-sm">
                                <div class="input-group-btn" [class.open]="model.decks?.length > 0">
                                    <button #deckSearck disabled type="button" class="btn input-group-addon dropdown-toggle" style="width: 100%;" 
                                        data-toggle="dropdown" aria-haspopup="true" (aria-expanded)="model.decks?.length > 0">
                                    </button>
                                    <div #deckIntellisense class="deckIntellisense dropdown-menu" style="width: 400px;" aria-labelledby="deckSearck">
                                        <a class="pointerCursor dropdown-item" [class.disabled]="model.deck?.id != undefined" (click)=selectDeck(deck) *ngFor="let deck of model.decks">
                                            <span class="deckIntellisenseSelect"><strong>{{deck.id}} - {{deck.name}}</strong></span>
                                        </a>
                                    </div>
                                </div>
                                <input #deckName required (ngControl)="deckName" name="deckName" [(ngModel)]="deck.name"
                                    (keydown)="analyseDeckName($event)" (focus)="clearDecks()"
                                    class="form-control" placeholder="Deck Name" type="text"  />
                            </div>
                        </div>
                        <div class="col-xs-1 actionColumn parameterInputTop">
                            <div class="updateDeckBtn btn-group">
                                <button type="submit" [disabled]="!postDeck.form.valid" 
                                    class="imageBtn btn btn-secondary">
                                    <i class="fa fa-play-circle-o" *ngIf="!model.updating"></i>
                                    <i class="fa fa-circle-o-notch fa-spin" *ngIf="model.updating"></i>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="row-fluid clearfix">
                    <div class="searchResultsHead btn-group" role="group" style="margin-top: 5px; margin-bottom: 5px;">
                        <button type="button" class="btn btn-primary-outline" style="pading: 5px; font-size: 12px;"
                            [class.active]="model.selectedBoard == 1" 
                            *ngIf="deck.cards != undefined" (click)="model.selectedBoard = 1">
                            Main <span class="badge">{{calculateMainCardsSize() + "/" + (deck.cards | filter:"deckCard.idBoard":1).length}}</span>
                        </button>
                        <button type="button" class="btn btn-info-outline" style="pading: 5px; font-size: 12px;" 
                            [class.active]="model.selectedBoard == 2" 
                            *ngIf="deck.cards != undefined" (click)="model.selectedBoard = 2">
                            Side <span class="badge">{{calculateSideCardsSize() + "/" + (deck.cards | filter:"deckCard.idBoard":2).length}}</span>
                        </button>
                    </div>
                    <div class="container-fluid" style="padding: 0px;">
                        <div class="row-fluid clearfix">
                            <div class="searchResultsBodyDeck col-xs-12" style="padding: 0px;">
                                <div class="searchResultsItem col-xs-12 col-sm-6 col-md-6 col-lg-4 col-xl-4" *ngFor="let deckItem of deck.cards | filter:'deckCard.idBoard':model.selectedBoard">
                                    <div class="cardFrame card text-xs-center">
                                        <div class="card-header text-xs-center">
                                            <span class="searchResultsItemTitle"><strong>{{deckItem.name}}</strong></span>
                                            <img src="/api/asset/{{deckItem.expansion.idAsset}}" style="height: 18px; vertical-align: middle;" />
                                        </div>
                                        <img class="card-img searchResultsDeckImg" src="/api/asset/{{deckItem.idAsset}}" 
                                        [class.show50]="deckItem.deckCard.quantity <= 0"
                                        />
                                        <img class="card-img" ngShow="false" ngSrc="/web/app/assets/images/magic_card.jpg" />
                                        <div class="actionOverlay card-img-overlay">
                                            <div class="cardDetailsDeck center-block">
                                                <div class="cardQtdLabel"
                                                [class.text-danger]="deckItem.inventoryCard.quantity <= 0"
                                                [class.text-success]="deckItem.deckCard.quantity > 0 && deckItem.inventoryCard.quantity >= deckItem.deckCard.quantity"
                                                [class.text-warning]="deckItem.inventoryCard.quantity > 0 && deckItem.inventoryCard.quantity < deckItem.deckCard.quantity">
                                                    {{getDeckItemLabel(deckItem)}}</div>
                                                <div class="actionPanel hide">
                                                    <button class="action btn btn-secondary" (click)="removeCard(deckItem)">
                                                        <i class="fa fa-minus-circle"></i>
                                                    </button>
                                                    <button class="action btn btn-secondary" (click)="addCard(deckItem)">
                                                        <i class="fa fa-plus-circle"></i>
                                                    </button>
                                                    <button class="action btn btn-secondary" (click)="removeDeckItem(deckItem)">
                                                        <i class="fa fa-times-circle"></i>
                                                    </button>
                                                    <button class="action btn btn-secondary" (click)="showCard(deckItem)">
                                                        <i class="fa fa-eye"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="searchResultsFoot row-fluid clearfix"></div>
</div>